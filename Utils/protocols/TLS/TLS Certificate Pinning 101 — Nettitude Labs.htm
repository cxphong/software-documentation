<!DOCTYPE html>
<!-- saved from url=(0065)https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/ -->
<html lang="en-US" class="html_boxed responsive av-preloader-disabled av-custom-lightbox  html_header_top html_logo_left html_bottom_nav_header html_menu_left html_slim html_header_sticky html_header_shrinking html_mobile_menu_phone html_header_mobile_behavior html_header_searchicon html_content_align_center html_header_unstick_top_disabled html_header_stretch_disabled html_minimal_header html_entry_id_12714  avia_desktop  js_active  avia_transform  avia_transform3d  avia_transform  avia_transform3d  avia-webkit avia-webkit-78 avia-chrome avia-chrome-78 avia-mac"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<!-- mobile setting -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- Scripts/CSS and wp_head hook -->
<title>TLS Certificate Pinning 101 — Nettitude Labs</title>

<!-- This site is optimized with the Yoast SEO plugin v12.5 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<link rel="canonical" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="TLS Certificate Pinning 101 — Nettitude Labs">
<meta property="og:description" content="Introduction What is certificate pinning? Certificate pinning is the process of associating a host with their expected X.509 certificate or public key. Once a certificate or public key is known or seen for a host, the certificate or public key is associated or ‘pinned’ to the host. A host or service’s certificate or public key …">
<meta property="og:url" content="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/">
<meta property="og:site_name" content="Nettitude Labs">
<meta property="og:image" content="https://labs.nettitude.com/wp-content/uploads/2018/03/word-image.jpeg">
<meta property="og:image:secure_url" content="https://labs.nettitude.com/wp-content/uploads/2018/03/word-image.jpeg">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="Introduction What is certificate pinning? Certificate pinning is the process of associating a host with their expected X.509 certificate or public key. Once a certificate or public key is known or seen for a host, the certificate or public key is associated or ‘pinned’ to the host. A host or service’s certificate or public key […]">
<meta name="twitter:title" content="TLS Certificate Pinning 101 — Nettitude Labs">
<meta name="twitter:image" content="https://labs.nettitude.com/wp-content/uploads/2018/03/word-image.jpeg">
<script id="twitter-wjs" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/widgets.js"></script><script async="" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/analytics.js"></script><script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://labs.nettitude.com/#website","url":"https://labs.nettitude.com/","name":"Nettitude Labs","potentialAction":{"@type":"SearchAction","target":"https://labs.nettitude.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#primaryimage","url":"https://labs.nettitude.com/wp-content/uploads/2018/03/word-image.jpeg","width":292,"height":173},{"@type":"WebPage","@id":"https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#webpage","url":"https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/","inLanguage":"en-US","name":"TLS Certificate Pinning 101 &mdash; Nettitude Labs","isPartOf":{"@id":"https://labs.nettitude.com/#website"},"primaryImageOfPage":{"@id":"https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#primaryimage"},"datePublished":"2018-03-13T12:31:07+00:00","dateModified":"2018-03-13T12:32:52+00:00"}]}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Nettitude Labs » Feed" href="https://labs.nettitude.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Nettitude Labs » Comments Feed" href="https://labs.nettitude.com/comments/feed/">

<!-- google webfont font replacement -->
<link rel="stylesheet" id="avia-google-webfont" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/css(1)" type="text/css" media="all"> 
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/labs.nettitude.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=2fde81e1caced1a36bb036e0ed965697"}};
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./TLS Certificate Pinning 101 — Nettitude Labs_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="crayon-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="avia-grid-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/grid.css" type="text/css" media="all">
<link rel="stylesheet" id="avia-base-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/base.css" type="text/css" media="all">
<link rel="stylesheet" id="avia-layout-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/layout.css" type="text/css" media="all">
<link rel="stylesheet" id="avia-scs-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/shortcodes.css" type="text/css" media="all">
<link rel="stylesheet" id="avia-popup-css-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/magnific-popup.css" type="text/css" media="screen">
<link rel="stylesheet" id="avia-media-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/mediaelementplayer.css" type="text/css" media="screen">
<link rel="stylesheet" id="avia-print-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/print.css" type="text/css" media="print">
<link rel="stylesheet" id="avia-dynamic-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/enfold.css" type="text/css" media="all">
<link rel="stylesheet" id="avia-custom-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/custom.css" type="text/css" media="all">
<link rel="stylesheet" id="social-logos-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/social-logos.min.css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./TLS Certificate Pinning 101 — Nettitude Labs_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/jquery.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/labs.nettitude.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/crayon.min.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/avia-compat.js"></script>
<link rel="https://api.w.org/" href="https://labs.nettitude.com/wp-json/">

<link rel="shortlink" href="https://wp.me/P7EwYR-3j4">
<link rel="alternate" type="application/json+oembed" href="https://labs.nettitude.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Flabs.nettitude.com%2Ftutorials%2Ftls-certificate-pinning-101%2F">
<link rel="alternate" type="text/xml+oembed" href="https://labs.nettitude.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Flabs.nettitude.com%2Ftutorials%2Ftls-certificate-pinning-101%2F&amp;format=xml">

<link rel="dns-prefetch" href="https://v0.wordpress.com/">
<style type="text/css">img#wpstats{display:none}</style><link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="alternate" type="application/rss+xml" title="Nettitude Labs RSS2 Feed" href="https://labs.nettitude.com/feed/">
<link rel="pingback" href="https://labs.nettitude.com/xmlrpc.php">
<!--[if lt IE 9]><script src="https://labs.nettitude.com/wp-content/themes/enfold/js/html5shiv.js"></script><![endif]-->
<link rel="icon" href="https://www.nettitude.co.uk/wp-content/uploads/2013/04/favicon.png" type="image/png">
			<style type="text/css" id="wp-custom-css">
				.post {
	text-align: justify;
}

#main > div.container_wrap.container_wrap_first.main_color.sidebar_right > div > main > article > div > div *
{
	text-align:justify;	
}

#main > * span.blog-categories.minor-meta > a {

	color: #fff;
	pointer-events: none;
	
}

#main > * div.slide-meta-comments > a {
	display: none;
}

#main > * div.slide-meta > div.slide-meta-del{
	display: none;	
}

#main > * div.slide-meta > time {
	font-style: italic;
}

#main > div.container_wrap.container_wrap_first.main_color.sidebar_right > div > main > article > div.big-preview.single-big > a * {
	display: none;	
}

#main > div.main_color.container_wrap_first.container_wrap.sidebar_right > div > main > div > div > div > div > div.avia-content-slider-inner > * div > a
{
	color: #009A17;
	padding-top: 1em;
}

#main > div.stretch_full.container_wrap.alternate_color.light_bg_color.title_container > div > strong > a {
font-family: Droid sans;	
font-size: 18px;
}

#main > * strong{
	color: #221C35;
}

#main > div.container_wrap.container_wrap_first.main_color.sidebar_right > div > main > article > div.entry-content-wrapper.clearfix.standard-content > header > span > *
{
	 display:none;
}

#main > div.container_wrap.container_wrap_first.main_color.sidebar_right > div > main > article > div.entry-content-wrapper.clearfix.standard-content > div.entry-content > h2 
{
	font-size: 1.3em;
}

#main > div.container_wrap.container_wrap_first.main_color.sidebar_right > div > main > article > div.entry-content-wrapper.clearfix.standard-content > div.entry-content > h3
{
	font-size: 1em;
}
			</style>
		

<!--
Debugging Info for Theme support: 

Theme: Enfold
Version: 3.7.1
Installed: enfold
AviaFramework Version: 4.5.3
AviaBuilder Version: 0.9
ML:128-PU:21-PLA:10
WP:5.3
Updates: enabled
-->

<style type="text/css">
@font-face {font-family: 'entypo-fontello'; font-weight: normal; font-style: normal;
src: url('https://labs.nettitude.com/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.eot?v=3');
src: url('https://labs.nettitude.com/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.eot?v=3#iefix') format('embedded-opentype'), 
url('https://labs.nettitude.com/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.woff?v=3') format('woff'), 
url('https://labs.nettitude.com/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.ttf?v=3') format('truetype'), 
url('https://labs.nettitude.com/wp-content/themes/enfold/config-templatebuilder/avia-template-builder/assets/fonts/entypo-fontello.svg?v=3#entypo-fontello') format('svg');
} #top .avia-font-entypo-fontello, body .avia-font-entypo-fontello, html body [data-av_iconfont='entypo-fontello']:before{ font-family: 'entypo-fontello'; }
</style><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83632400-1', 'auto');
  ga('send', 'pageview');

</script>
<script async="" type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/count.js"></script><style type="text/css" id="av-browser-width-mm"></style><script charset="utf-8" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/moment_timeline_tweet.cb38d07468ec6018c11772ae620672f0.js"></script><script charset="utf-8" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/timeline.9ef4ef7dc9363096f08cc20d7b499dcb.js"></script></head>




<body id="top" class="page-template-default page page-id-12714 page-child parent-pageid-28 boxed droid_serif droid_sans " itemscope="itemscope" itemtype="https://schema.org/WebPage">

	
	<div id="wrap_all"><a id="advanced_menu_hide" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello"></a><ul id="mobile-advanced" class=""><li id="menu-item-11433" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-top-level menu-item-top-level-1"><a href="https://labs.nettitude.com/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Blog</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li id="menu-item-25" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-top-level menu-item-top-level-2"><a href="https://labs.nettitude.com/tools/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Tools</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a>


<ul class="sub-menu">
	<li id="menu-item-11617" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a href="https://labs.nettitude.com/tools/poshc2/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PoshC2</span></a>
	<ul class="sub-menu">
		<li id="menu-item-12681" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/poshc2/poshc2-documentation/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PoshC2 Documentation</span></a></li>
		<li id="menu-item-12971" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a title="PoshC2 Blogs" href="https://labs.nettitude.com/category/blog/poshc2/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PoshC2 Blogs</span></a></li>
	</ul>
</li>
	<li id="menu-item-13077" class="menu-item menu-item-type-post_type menu-item-object-post"><a href="https://labs.nettitude.com/blog/introducing-scrounger-ios-and-android-mobile-application-penetration-testing-framework/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Scrounger – iOS &amp; Android penetration testing framework</span></a></li>
	<li id="menu-item-13046" class="menu-item menu-item-type-post_type menu-item-object-post"><a href="https://labs.nettitude.com/blog/com-and-the-powerthief/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PowerThIEf</span></a></li>
	<li id="menu-item-13743" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><a target="_blank" href="https://github.com/nettitude/SharpSocks" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">SharpSocks</span></a>
	<ul class="sub-menu">
		<li id="menu-item-13729" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://labs.nettitude.com/category/blog/sharpsocks/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">SharpSocks Blogs</span></a></li>
	</ul>
</li>
	<li id="menu-item-13048" class="menu-item menu-item-type-post_type menu-item-object-post"><a href="https://labs.nettitude.com/blog/extending-c2-lateral-movement-invoke-pbind/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Invoke-Pbind</span></a></li>
	<li id="menu-item-12789" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/prowl/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Prowl</span></a></li>
	<li id="menu-item-11618" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/xss_payloads/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">XSS Payloads</span></a></li>
	<li id="menu-item-11694" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/rocktastic/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Rocktastic</span></a></li>
	<li id="menu-item-11730" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/zeropress/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">ZeroPress</span></a></li>
	<li id="menu-item-12129" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/logparser-query-files/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Microsoft Logparser Query Files</span></a></li>
</ul>
</li>
<li id="menu-item-29" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor current-menu-ancestor current-menu-parent current-page-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-top-level menu-item-top-level-3"><a href="https://labs.nettitude.com/tutorials/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Tutorials</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a>


<ul class="sub-menu">
	<li id="menu-item-12287" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tutorials/how-to-fix-burp-suite-ssltls-connection-problems/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">How to fix Burp Suite SSL/TLS connection problems</span></a></li>
	<li id="menu-item-12717" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-12714 current_page_item"><a href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">TLS Certificate Pinning 101</span></a></li>
	<li id="menu-item-12741" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tutorials/using-frida-to-bypass-snapchats-certificate-pinning/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Using Frida to Bypass Snapchat’s Certificate Pinning</span></a></li>
</ul>
</li>
<li id="menu-item-12820" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-top-level menu-item-top-level-4"><a href="https://labs.nettitude.com/training/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Training</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a>


<ul class="sub-menu">
	<li id="menu-item-12841" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/training/advanced-threat-actor-simulation-and-red-team-training/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Advanced Threat Actor Simulation – Red Team Training</span></a></li>
</ul>
</li>
<li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-top-level menu-item-top-level-5"><a href="https://labs.nettitude.com/jobs/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Jobs</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a>


<ul class="sub-menu">
	<li id="menu-item-13301" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/red-teaming-simulated-attack-manager/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Red Teaming – Simulated Attack Manager</span></a></li>
	<li id="menu-item-12466" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/red-teaming/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Red Teaming – Simulated Attack Specialist</span></a></li>
	<li id="menu-item-99" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/penetration-testing/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Penetration Testing</span></a></li>
	<li id="menu-item-98" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/accelerator-scheme/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Accelerator Scheme</span></a></li>
	<li id="menu-item-97" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/research/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Research</span></a></li>
	<li id="menu-item-12509" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/senior-soc-analyst-usa/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Senior SOC Analyst – USA</span></a></li>
	<li id="menu-item-12907" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/ir-consultant/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">IR Consultant</span></a></li>
</ul>
</li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-mega-parent  menu-item-top-level menu-item-top-level-6"><a href="https://labs.nettitude.com/contact/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Contact</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li id="menu-item-13345" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-top-level menu-item-top-level-7"><a target="_blank" href="https://www.nettitude.com/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Nettitude.com</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
</ul>

	
<header id="header" class="all_colors header_color light_bg_color av_header_top av_logo_left av_bottom_nav_header av_menu_left av_slim av_header_sticky av_header_shrinking av_header_stretch_disabled av_mobile_menu_phone av_header_searchicon av_header_unstick_top_disabled av_seperator_small_border av_minimal_header av_alternate_logo_active header-scrolled header-scrolled-full" role="banner" itemscope="itemscope" itemtype="https://schema.org/WPHeader">

		<div id="header_main" class="container_wrap container_wrap_logo">
	
        <div class="container av-logo-container" style="height: 45px; line-height: 45px;"><div class="inner-container"><strong class="logo"><a href="https://labs.nettitude.com/" style="max-height: 45px;"><img height="100" width="300" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/NETT_LABS_LOGO-new.png" alt="Nettitude Labs" scale="0" style="max-height: 45px;"></a></strong><a id="advanced_menu_toggle" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello"></a><ul class="noLightbox social_bookmarks icon_count_2"><li class="social_bookmarks_twitter av-social-link-twitter social_icon_1"><a target="_blank" href="https://twitter.com/nettitude_labs" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" title="Twitter"><span class="avia_hidden_link_text">Twitter</span></a></li><li class="social_bookmarks_youtube av-social-link-youtube social_icon_2"><a target="_blank" href="https://www.youtube.com/channel/UCrGjkGFt-hGgfUKZfuVO2vA" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" title="Youtube"><span class="avia_hidden_link_text">Youtube</span></a></li></ul></div></div><div id="header_main_alternate" class="container_wrap"><div class="container"><nav class="main_menu" data-selectname="Select a page" role="navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement"><div class="avia-menu av-main-nav-wrap"><ul id="avia-menu" class="menu av-main-nav"><li id="menu-item-11433" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-top-level menu-item-top-level-1"><a href="https://labs.nettitude.com/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Blog</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li id="menu-item-25" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-top-level menu-item-top-level-2 dropdown_ul_available"><a href="https://labs.nettitude.com/tools/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Tools</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span><span class="dropdown_available"></span></a>


<ul class="sub-menu" style="display: block; opacity: 0; visibility: hidden;">
	<li id="menu-item-11617" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children"><a href="https://labs.nettitude.com/tools/poshc2/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PoshC2</span></a>
	<ul class="sub-menu" style="display: block; opacity: 0; visibility: hidden;">
		<li id="menu-item-12681" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/poshc2/poshc2-documentation/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PoshC2 Documentation</span></a></li>
		<li id="menu-item-12971" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a title="PoshC2 Blogs" href="https://labs.nettitude.com/category/blog/poshc2/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PoshC2 Blogs</span></a></li>
	</ul>
</li>
	<li id="menu-item-13077" class="menu-item menu-item-type-post_type menu-item-object-post"><a href="https://labs.nettitude.com/blog/introducing-scrounger-ios-and-android-mobile-application-penetration-testing-framework/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Scrounger – iOS &amp; Android penetration testing framework</span></a></li>
	<li id="menu-item-13046" class="menu-item menu-item-type-post_type menu-item-object-post"><a href="https://labs.nettitude.com/blog/com-and-the-powerthief/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">PowerThIEf</span></a></li>
	<li id="menu-item-13743" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children"><a target="_blank" href="https://github.com/nettitude/SharpSocks" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">SharpSocks</span></a>
	<ul class="sub-menu" style="display: block; opacity: 0; visibility: hidden;">
		<li id="menu-item-13729" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://labs.nettitude.com/category/blog/sharpsocks/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">SharpSocks Blogs</span></a></li>
	</ul>
</li>
	<li id="menu-item-13048" class="menu-item menu-item-type-post_type menu-item-object-post"><a href="https://labs.nettitude.com/blog/extending-c2-lateral-movement-invoke-pbind/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Invoke-Pbind</span></a></li>
	<li id="menu-item-12789" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/prowl/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Prowl</span></a></li>
	<li id="menu-item-11618" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/xss_payloads/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">XSS Payloads</span></a></li>
	<li id="menu-item-11694" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/rocktastic/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Rocktastic</span></a></li>
	<li id="menu-item-11730" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/zeropress/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">ZeroPress</span></a></li>
	<li id="menu-item-12129" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tools/logparser-query-files/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Microsoft Logparser Query Files</span></a></li>
</ul>
</li>
<li id="menu-item-29" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor current-menu-ancestor current-menu-parent current-page-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-top-level menu-item-top-level-3 active-parent-item dropdown_ul_available"><a href="https://labs.nettitude.com/tutorials/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Tutorials</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span><span class="dropdown_available"></span></a>


<ul class="sub-menu" style="display: block; opacity: 0; visibility: hidden;">
	<li id="menu-item-12287" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tutorials/how-to-fix-burp-suite-ssltls-connection-problems/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">How to fix Burp Suite SSL/TLS connection problems</span></a></li>
	<li id="menu-item-12717" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-12714 current_page_item"><a href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">TLS Certificate Pinning 101</span></a></li>
	<li id="menu-item-12741" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/tutorials/using-frida-to-bypass-snapchats-certificate-pinning/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Using Frida to Bypass Snapchat’s Certificate Pinning</span></a></li>
</ul>
</li>
<li id="menu-item-12820" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-top-level menu-item-top-level-4 dropdown_ul_available"><a href="https://labs.nettitude.com/training/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Training</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span><span class="dropdown_available"></span></a>


<ul class="sub-menu" style="display: block; opacity: 0; visibility: hidden;">
	<li id="menu-item-12841" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/training/advanced-threat-actor-simulation-and-red-team-training/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Advanced Threat Actor Simulation – Red Team Training</span></a></li>
</ul>
</li>
<li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-top-level menu-item-top-level-5 dropdown_ul_available"><a href="https://labs.nettitude.com/jobs/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Jobs</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span><span class="dropdown_available"></span></a>


<ul class="sub-menu" style="display: block; opacity: 0; visibility: hidden;">
	<li id="menu-item-13301" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/red-teaming-simulated-attack-manager/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Red Teaming – Simulated Attack Manager</span></a></li>
	<li id="menu-item-12466" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/red-teaming/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Red Teaming – Simulated Attack Specialist</span></a></li>
	<li id="menu-item-99" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/penetration-testing/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Penetration Testing</span></a></li>
	<li id="menu-item-98" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/accelerator-scheme/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Accelerator Scheme</span></a></li>
	<li id="menu-item-97" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/research/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Research</span></a></li>
	<li id="menu-item-12509" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/senior-soc-analyst-usa/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Senior SOC Analyst – USA</span></a></li>
	<li id="menu-item-12907" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://labs.nettitude.com/jobs/ir-consultant/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">IR Consultant</span></a></li>
</ul>
</li>
<li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-mega-parent  menu-item-top-level menu-item-top-level-6"><a href="https://labs.nettitude.com/contact/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Contact</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li id="menu-item-13345" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-top-level menu-item-top-level-7"><a target="_blank" href="https://www.nettitude.com/" itemprop="url"><span class="avia-bullet"></span><span class="avia-menu-text">Nettitude.com</span><span class="avia-menu-fx"><span class="avia-arrow-wrap"><span class="avia-arrow"></span></span></span></a></li>
<li id="menu-item-search" class="noMobile menu-item menu-item-search-dropdown">
							<a href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/?s=" rel="nofollow" data-avia-search-tooltip="

&lt;form action=&quot;https://labs.nettitude.com/&quot; id=&quot;searchform&quot; method=&quot;get&quot; class=&quot;&quot;&gt;
	&lt;div&gt;
		&lt;input type=&quot;submit&quot; value=&quot;&quot; id=&quot;searchsubmit&quot; class=&quot;button avia-font-entypo-fontello&quot; /&gt;
		&lt;input type=&quot;text&quot; id=&quot;s&quot; name=&quot;s&quot; value=&quot;&quot; placeholder=&#39;Search&#39; /&gt;
			&lt;/div&gt;
&lt;/form&gt;" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello"><span class="avia_hidden_link_text">Search</span></a>
	        		   </li></ul></div></nav></div> </div> 
		<!-- end container_wrap-->
		</div>
		
		<div class="header_bg"></div>

<!-- end header -->
</header>
		
	<div id="main" class="all_colors" data-scroll-offset="88">

	<div class="stretch_full container_wrap alternate_color light_bg_color title_container"><div class="container"><h1 class="main-title entry-title"><a href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/" rel="bookmark" title="Permanent Link: TLS Certificate Pinning 101" itemprop="headline">TLS Certificate Pinning 101</a></h1><div class="breadcrumb breadcrumbs avia-breadcrumbs"><div class="breadcrumb-trail" xmlns:v="http://rdf.data-vocabulary.org/#"><span class="trail-before"><span class="breadcrumb-title">You are here:</span></span> <a href="https://labs.nettitude.com/" title="Nettitude Labs" rel="home" class="trail-begin">Home</a> <span class="sep">/</span> <span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="https://labs.nettitude.com/tutorials/" title="Tutorials">Tutorials</a></span> <span class="sep">/</span> <span class="trail-end">TLS Certificate Pinning 101</span></div></div></div></div>
		<div class="container_wrap container_wrap_first main_color sidebar_right">

			<div class="container">

				<main class="template-page content  av-content-small alpha units" role="main" itemprop="mainContentOfPage">

                    
		<article class="post-entry post-entry-type-page post-entry-12714" itemscope="itemscope" itemtype="https://schema.org/CreativeWork">

			<div class="entry-content-wrapper clearfix">
                <header class="entry-content-header"></header><div class="entry-content" itemprop="text"><h1>Introduction</h1>
<h2>What is certificate pinning?</h2>
<p>Certificate pinning is the process of associating a host with their expected X.509 certificate or public key. Once a certificate or public key is known or seen for a host, the certificate or public key is associated or ‘pinned’ to the host.</p>
<p>A host or service’s certificate or public key can be added to an application at development time, or it can be added upon first encountering the certificate or public key. The former – adding at development time – is preferred since preloading the certificate or public key out of band usually means the attacker cannot taint the pin. If the certificate or public key is added upon first encounter, this is known as key continuity. Key continuity can fail if the attacker has a privileged position during the first encounter.</p>
<p>Pinning leverages knowledge of the pre-existing relationship between the user and an organization or service to help make better security related decisions. Because the application already has information on the server or service, it does not need to rely on generalised mechanisms meant to solve the key distribution problem. That is, it does not need to turn to DNS for name/address mappings or trusted CAs for bindings and status. No key distribution problems when there is no key distribution!</p>
<p><img class="wp-image-12715 aligncenter" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/word-image.jpeg" alt="" width="419" height="248" scale="0"></p>
<h2>Why should you always pin?</h2>
<p>Mobile applications should utilise either certificate or public key pinning in order to ensure that communications are secure. This is usually implemented when the developer of the application needs to validate the remote host’s identity or when operating in a hostile environment. Since one or both of these are almost always true, it is recommended that the majority of applications implement pinning.</p>
<p>OWASP’s page on Certificate and Public Key Pinning[1] reads:</p>
<p><em>“You should pin anytime you want to be relatively certain of the remote host’s identity or when operating in a hostile environment. Since one or both are almost always true, you should probably pin all the time.”</em></p>
<p>– <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning" target="_blank" rel="noopener">https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning</a></p>
<h1>Where and what to pin?</h1>
<p>Certificate pinning can be implemented in a great many different ways. The pinning strategy should be carefully designed as there are many trade-offs to consider:</p>
<ul>
<li>What to pin?
<ul>
<li>Certificate</li>
<li>Public key</li>
<li>Hash</li>
</ul>
</li>
<li>Where to pin?
<ul>
<li>The server’s certificate (a.k.a. <em>leaf certificate</em>)</li>
<li>The Certificate Authority’s certificate (a.k.a. <em>root certificate</em>)</li>
<li>An intermediate certificate</li>
<li>The whole certificate chain</li>
</ul>
</li>
</ul>
<p>These decisions will affect the security but also the longevity of the solution. For example, pinning connections against the whole certificate chain will be the more robust strategy, but if any of the certificates in the chain change (for legitimate reasons) then the application will be unable to establish connections without users updating to a newer/rectified version. As another example, if the application pins connections against the leaf certificate’s public key, connections will remain securely pinned even if the CA is compromised.</p>
<h2>Where to pin?</h2>
<h3>Leaf certificate</h3>
<ul>
<li>Guarantees with close to 100% certainty that this is your certificate
<ul>
<li>even if Root CA was compromised</li>
</ul>
</li>
<li>If the certificate becomes invalid for some reason (either normal expiration or compromise) the app will be bricked until you can push an update out</li>
<li>Allows self-signed certificates – which can be a good thing from an ease of maintenance perspective</li>
</ul>
<h3>Root certificate</h3>
<ul>
<li>By pinning against the root certificate you are trusting the root certificate authority as well as any intermediaries they trust not to mis-issue certificates</li>
<li>If CA gets compromised it’s game over</li>
<li>Very important to maintain strong certificate validation
<ul>
<li>Pinning is not an excuse for bad certificate validation!</li>
</ul>
</li>
</ul>
<h3>Intermediate certificate:</h3>
<ul>
<li>By pinning against an intermediate certificate you are trusting that the intermediate certificate authority to not mis-issue a certificate for your server(s)</li>
<li>As long as you stick to the same certificate provider then any changes to your leaf certificates will work without having to update your app</li>
</ul>
<h2>What to pin?</h2>
<h3>Certificate</h3>
<ul>
<li>Normally the certificate is easiest to pin</li>
<li>At runtime, you retrieve the website or server’s certificate</li>
<li>You compare the retrieved certificate with the certificate embedded within the application</li>
<li>If the site/service rotates its certificate on a regular basis, then your application would need to be updated regularly</li>
</ul>
<h3>Public key</h3>
<ul>
<li>More flexible</li>
<li>A little trickier due to the extra steps necessary to extract the public key from a certificate
<ul>
<li>Its harder to work with keys since you must extract the key from the certificate – can be somewhat of a pain in <em>Cocoa</em>/<em>CocoaTouch</em> and <em>OpenSSL</em>.</li>
</ul>
</li>
<li>As with a certificate, the program checks the extracted public key with its embedded copy of the public key</li>
</ul>
<h3>Hash</h3>
<ul>
<li>Allows you to anonymize a certificate or public key
<ul>
<li>this might be important if you application is concerned about leaking information during decompilation and reverse engineering</li>
</ul>
</li>
<li>A digested certificate fingerprint is often available as a native API for many libraries, so its convenient to use</li>
<li>An organization might want to supply a reserve identity in case the primary identity is compromised</li>
</ul>
<p>As these examples show, there are different implications that should be considered when implementing certificate pinning.</p>
<h1>How should you pin?</h1>
<p>From a technical perspective, it is not recommended that the pinned certificates are loaded from the filesystem as it unnecessarily extends the attack surface. It is recommended that the certificate, its public key or a secure hash of it are embedded into the application, paired with strong obfuscation and tamper detection mechanisms. Note that TLS certificate pinning without effective jailbreak/root detection and other advanced binary/runtime protections is a moot point: when the application runs on a jailbroken/rooted device, root will be able to instrument the application and bypass the pinning controls. The stronger the controls of your application, the more time and skill will be required from the adversary.</p>
<h2>iOS</h2>
<p>One of the most common ways of implementing certificate pinning for an iOS application, is to implement the <em>didReceiveAuthenticationChallenge</em> method in the <em>NSURLConnectionDelegate</em>. The custom certificate checks can be performed within the <em>didReceiveAuthenticationChallenge </em>method. Note that certificate validation should still be performed throughout the chain, which can be achieved by invoking <em>SecTrustEvaluate</em> in the delegate, before the custom certificate checks.</p>
<p>Further ways of implementing certificate pinning – namely using the <em>AFNetworking</em> and <em>AlamoFire</em> frameworks – are covered in [2].</p>
<h2>Android</h2>
<p>In Android, the most common ways of implementing certificate pinning are usually:</p>
<ol>
<li>by creating a new class that extends <em>X509TrustManager</em> and implementing the bespoke certificate checks in the <em>checkServerTrusted</em> method; or</li>
<li>by creating an empty <em>KeyStore</em>, adding the relevant certificates to it, and then:
<ol>
<li>initialising a <em>TrustManagerFactory</em> with this <em>KeyStore</em>;</li>
<li>initialising the <em>SSLContext</em> with this <em>TrustManagerFactory</em>.</li>
</ol>
</li>
</ol>
<p>A multitude of frameworks exist in Android, which allow developers to implement certificate pinning. Some of the most common ones are covered in [3]. This includes Android N’s (and above) <em>Network Security Configuration</em>. Network Security Configuration</p>
<p>Through a simple entry in the <em>AndroidManifest.xml </em>file the developer specifies an XML configuration file that defines the pins required. In fact, this solution works much better than previous solutions for pinning <em>WebViews</em>’ connections – with no additional effort on the developer’s part. It is also easy to support self-signed certificates or certificate authorities that are not trusted system root certificates.</p>
<p>However, both in iOS and Android platforms, there is a multitude of ways certificate pinning can be hardened. For example, using <em>OpenSSL</em> as a static library compiled with the app and using it for all connections would significantly increase the complexity for an attacker trying to instrument the application and bypass the pinning controls.</p>
<h1>Some useful resources</h1>
<ol>
<li>OWASP – Certificate and Public Key Pinning: <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning" target="_blank" rel="noopener">https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning</a></li>
<li>How to make your iOS apps more secure with SSL pinning: <a href="https://infinum.co/the-capsized-eight/how-to-make-your-ios-apps-more-secure-with-ssl-pinning" target="_blank" rel="noopener">https://infinum.co/the-capsized-eight/how-to-make-your-ios-apps-more-secure-with-ssl-pinning</a></li>
<li>Android Security – SSL Pinning: <a href="https://medium.com/@appmattus/android-security-ssl-pinning-1db8acb6621e" target="_blank" rel="noopener">https://medium.com/@appmattus/android-security-ssl-pinning-1db8acb6621e</a></li>
<li>Android – Network Security Configuration: <a href="https://developer.android.com/training/articles/security-config.html" target="_blank" rel="noopener">https://developer.android.com/training/articles/security-config.html</a></li>
<li>Android – JustTrustMe: <a href="https://github.com/Fuzion24/JustTrustMe" target="_blank" rel="noopener">https://github.com/Fuzion24/JustTrustMe</a></li>
<li>iOS – SSL Kill Switch 2: <a href="https://github.com/nabla-c0d3/ssl-kill-switch2" target="_blank" rel="noopener">https://github.com/nabla-c0d3/ssl-kill-switch2</a></li>
</ol>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-12714" class="share-twitter sd-button share-icon" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-12714" class="share-facebook sd-button share-icon" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-12714" class="share-linkedin sd-button share-icon" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/?share=reddit&amp;nb=1" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-print"><a rel="nofollow noopener noreferrer" data-shared="" class="share-print sd-button share-icon" href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#print" target="_blank" title="Click to print"><span>Print</span></a></li><li class="share-end"></li></ul></div></div></div></div><footer class="entry-footer"></footer>			</div>

		</article><!--end post-entry-->



				<!--end content-->
				</main>

				<aside class="sidebar sidebar_right smartphones_sidebar_active alpha units" role="complementary" itemscope="itemscope" itemtype="https://schema.org/WPSideBar"><div class="inner_sidebar extralight-border"><section id="text-3" class="widget clearfix widget_text"><h3 class="widgettitle">GitHub</h3>			<div class="textwidget"><img src="./TLS Certificate Pinning 101 — Nettitude Labs_files/github-e1466539795501.png" scale="0"><br><span style="color: #707070;">Check out our latest projects at <a href="https://github.com/nettitude" target="_open" style="color: #009A17" rel="noopener noreferrer">https://github.com/nettitude</a></span></div>
		<span class="seperator extralight-border"></span></section><section id="twitter_timeline-3" class="widget clearfix widget_twitter_timeline"><h3 class="widgettitle">Twitter</h3><iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-timeline twitter-timeline-rendered" style="position: static; visibility: visible; display: inline-block; width: 350px; padding: 0px; border: none; max-width: 100%; min-width: 180px; margin-top: 0px; margin-bottom: 0px; height: 1092.94px;" data-widget-id="profile:nettitude_labs" title="Twitter Timeline" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/saved_resource(2).html"></iframe><span class="seperator extralight-border"></span></section></div></aside>
			</div><!--end container-->

		</div><!-- close default .container_wrap element -->



						<div class="container_wrap footer_color" id="footer">

					<div class="container">

						<div class="flex_column av_one_fifth  first el_before_av_one_fifth"><section id="text-4" class="widget clearfix widget_text">			<div class="textwidget"><iframe src="./TLS Certificate Pinning 101 — Nettitude Labs_files/embed.html" frameborder="0" style="border:0" allowfullscreen=""></iframe></div>
		<span class="seperator extralight-border"></span></section></div><div class="flex_column av_one_fifth  el_after_av_one_fifth  el_before_av_one_fifth "><section id="text-6" class="widget clearfix widget_text"><h3 class="widgettitle">EMEA</h3>			<div class="textwidget">1 Jephson Court <br>
Trancred Close <br>           
Leamington Spa <br>  
Warwickshire<br>      
CV31 3RZ<p></p></div>
		<span class="seperator extralight-border"></span></section></div><div class="flex_column av_one_fifth  el_after_av_one_fifth  el_before_av_one_fifth "><section id="text-5" class="widget clearfix widget_text"><h3 class="widgettitle">Americas</h3>			<div class="textwidget">50 Broad Street<br>
Suite 403<br>
New York<br>
NY<br>
10004<p></p></div>
		<span class="seperator extralight-border"></span></section></div><div class="flex_column av_one_fifth  el_after_av_one_fifth  el_before_av_one_fifth "><section id="text-7" class="widget clearfix widget_text"><h3 class="widgettitle">General Enquires</h3>			<div class="textwidget"><p><span class="av_font_icon avia_animate_when_visible av-icon-style-  avia-icon-pos-left  avia_start_animation avia_start_delayed_animation" style="color:#95c64a; border-color:#95c64a;"><span class="av-icon-char" style="font-size:20px;line-height:20px;" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" data-avia-icon-tooltip="+44 (0) 345 520 0085 (EMEA)"></span></span>+44 (0) 345 520 0085 (EMEA)</p>

<p><span class="av_font_icon avia_animate_when_visible av-icon-style-  avia-icon-pos-left  avia_start_animation avia_start_delayed_animation" style="color:#95c64a; border-color:#95c64a;"><span class="av-icon-char" style="font-size:20px;line-height:20px;" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" data-avia-icon-tooltip="+1 (212) 335 2238 (Americas)"></span></span> +1 (212) 335 2238 (Americas)

</p><p><span class="av_font_icon avia_animate_when_visible av-icon-style-  avia-icon-pos-left " style="color:#95c64a; border-color:#95c64a;"><span class="av-icon-char" style="font-size:20px;line-height:20px;" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" data-avia-icon-tooltip="labs@nettitude.com"></span></span> <a href="mailto:labs@nettitude.com">labs@nettitude.com</a></p>
</div>
		<span class="seperator extralight-border"></span></section></div><div class="flex_column av_one_fifth  el_after_av_one_fifth  el_before_av_one_fifth "><section id="text-9" class="widget clearfix widget_text"><h3 class="widgettitle">Social Media</h3>			<div class="textwidget"><p>
<span class="av_font_icon avia_animate_when_visible av-icon-style-  avia-icon-pos-left  avia_start_animation avia_start_delayed_animation" style="color:#95c64a; border-color:#95c64a;"><a href="https://twitter.com/nettitude_labs" target="_blank" class="av-icon-char" style="font-size:20px;line-height:20px;" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" data-avia-icon-tooltip="
Follow us on Twitter!
" rel="noopener noreferrer"></a></span><a href="https://twitter.com/nettitude_labs" target="_blank" "="" rel="noopener noreferrer">Nettitude Labs on Twitter</a></p>

<p>
<span class="av_font_icon avia_animate_when_visible av-icon-style-  avia-icon-pos-left  avia_start_animation avia_start_delayed_animation" style="color:#95c64a; border-color:#95c64a;"><a href="https://www.youtube.com/channel/UCrGjkGFt-hGgfUKZfuVO2vA" target="_blank" class="av-icon-char" style="font-size:20px;line-height:20px;" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" data-avia-icon-tooltip="Follow us on YouTube!
" rel="noopener noreferrer"></a></span><a href="https://www.youtube.com/channel/UCrGjkGFt-hGgfUKZfuVO2vA" target="_blank" rel="noopener noreferrer">Nettitude Labs on YouTube</a></p>
<p></p></div>
		<span class="seperator extralight-border"></span></section></div>

					</div>


				<!-- ####### END FOOTER CONTAINER ####### -->
				</div>

	


			

			
				<footer class="container_wrap socket_color" id="socket" role="contentinfo" itemscope="itemscope" itemtype="https://schema.org/WPFooter">
                    <div class="container">

                        <span class="copyright"> © Copyright - Nettitude Labs</span>

                        
                    </div>

	            <!-- ####### END SOCKET CONTAINER ####### -->
				</footer>


					<!-- end main -->
		</div>
		
		<!-- end wrap_all --></div>

	<div style="display:none">
	</div>

 <script type="text/javascript">
 /* <![CDATA[ */  
var avia_framework_globals = avia_framework_globals || {};
    avia_framework_globals.frameworkUrl = 'https://labs.nettitude.com/wp-content/themes/enfold/framework/';
    avia_framework_globals.installedAt = 'https://labs.nettitude.com/wp-content/themes/enfold/';
    avia_framework_globals.ajaxurl = 'https://labs.nettitude.com/wp-admin/admin-ajax.php';
/* ]]> */ 
</script>
 
 
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/labs.nettitude.com\/tutorials\/tls-certificate-pinning-101\/":12714};
	</script>
				<script type="text/javascript">
/* <![CDATA[ */
var countVars = {"disqusShortname":"nettitude-labs"};
/* ]]> */
</script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/comment_count.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/devicepx-jetpack.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/avia.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/shortcodes.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/jquery.magnific-popup.min.js"></script>
<script type="text/javascript">
var mejsL10n = {"language":"en","strings":{"mejs.install-flash":"You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https:\/\/get.adobe.com\/flashplayer\/","mejs.fullscreen-off":"Turn off Fullscreen","mejs.fullscreen-on":"Go Fullscreen","mejs.download-video":"Download Video","mejs.fullscreen":"Fullscreen","mejs.time-jump-forward":["Jump forward 1 second","Jump forward %1 seconds"],"mejs.loop":"Toggle Loop","mejs.play":"Play","mejs.pause":"Pause","mejs.close":"Close","mejs.time-slider":"Time Slider","mejs.time-help-text":"Use Left\/Right Arrow keys to advance one second, Up\/Down arrows to advance ten seconds.","mejs.time-skip-back":["Skip back 1 second","Skip back %1 seconds"],"mejs.captions-subtitles":"Captions\/Subtitles","mejs.captions-chapters":"Chapters","mejs.none":"None","mejs.mute-toggle":"Mute Toggle","mejs.volume-help-text":"Use Up\/Down Arrow keys to increase or decrease volume.","mejs.unmute":"Unmute","mejs.mute":"Mute","mejs.volume-slider":"Volume Slider","mejs.video-player":"Video Player","mejs.audio-player":"Audio Player","mejs.ad-skip":"Skip ad","mejs.ad-skip-info":["Skip in 1 second","Skip in %1 seconds"],"mejs.source-chooser":"Source Chooser","mejs.stop":"Stop","mejs.speed-rate":"Speed Rate","mejs.live-broadcast":"Live Broadcast","mejs.afrikaans":"Afrikaans","mejs.albanian":"Albanian","mejs.arabic":"Arabic","mejs.belarusian":"Belarusian","mejs.bulgarian":"Bulgarian","mejs.catalan":"Catalan","mejs.chinese":"Chinese","mejs.chinese-simplified":"Chinese (Simplified)","mejs.chinese-traditional":"Chinese (Traditional)","mejs.croatian":"Croatian","mejs.czech":"Czech","mejs.danish":"Danish","mejs.dutch":"Dutch","mejs.english":"English","mejs.estonian":"Estonian","mejs.filipino":"Filipino","mejs.finnish":"Finnish","mejs.french":"French","mejs.galician":"Galician","mejs.german":"German","mejs.greek":"Greek","mejs.haitian-creole":"Haitian Creole","mejs.hebrew":"Hebrew","mejs.hindi":"Hindi","mejs.hungarian":"Hungarian","mejs.icelandic":"Icelandic","mejs.indonesian":"Indonesian","mejs.irish":"Irish","mejs.italian":"Italian","mejs.japanese":"Japanese","mejs.korean":"Korean","mejs.latvian":"Latvian","mejs.lithuanian":"Lithuanian","mejs.macedonian":"Macedonian","mejs.malay":"Malay","mejs.maltese":"Maltese","mejs.norwegian":"Norwegian","mejs.persian":"Persian","mejs.polish":"Polish","mejs.portuguese":"Portuguese","mejs.romanian":"Romanian","mejs.russian":"Russian","mejs.serbian":"Serbian","mejs.slovak":"Slovak","mejs.slovenian":"Slovenian","mejs.spanish":"Spanish","mejs.swahili":"Swahili","mejs.swedish":"Swedish","mejs.tagalog":"Tagalog","mejs.thai":"Thai","mejs.turkish":"Turkish","mejs.ukrainian":"Ukrainian","mejs.vietnamese":"Vietnamese","mejs.welsh":"Welsh","mejs.yiddish":"Yiddish"}};
</script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/mediaelement-and-player.min.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/mediaelement-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var _wpmejsSettings = {"pluginPath":"\/wp-includes\/js\/mediaelement\/","classPrefix":"mejs-","stretching":"responsive"};
/* ]]> */
</script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/wp-mediaelement.min.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/twitter-timeline.min.js"></script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/wp-embed.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/sharing.min.js"></script>
<script type="text/javascript">
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-twitter', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-linkedin', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
				return false;
			});
</script>
<script type="text/javascript" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/e-201949.js" async="async" defer="defer"></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.9.1',blog:'113094253',post:'12714',tz:'0',srv:'labs.nettitude.com'} ]);
	_stq.push([ 'clickTrackerInit', '113094253', '12714' ]);
</script>
	<script type="text/javascript">
        jQuery(document).ready(function ($) {
            //$( document ).ajaxStart(function() {
            //});

			
            for (var i = 0; i < document.forms.length; ++i) {
                var form = document.forms[i];
				if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="vVTNrRzueiDYocgS" value="U3Zi9Nln8oWE[@ap" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="KRzcTiYx" value="LqDzi4Q]" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="fxgRNm" value="24buUa" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="_PdiRHOAr-Bt" value="vXobY[r43DAZ" />'); }
            }

			
            $(document).on('submit', 'form', function () {
				if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="vVTNrRzueiDYocgS" value="U3Zi9Nln8oWE[@ap" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="KRzcTiYx" value="LqDzi4Q]" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="fxgRNm" value="24buUa" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="_PdiRHOAr-Bt" value="vXobY[r43DAZ" />'); }
                return true;
            });

			
            jQuery.ajaxSetup({
                beforeSend: function (e, data) {

                    //console.log(Object.getOwnPropertyNames(data).sort());
                    //console.log(data.type);

                    if (data.type !== 'POST') return;

                    if (typeof data.data === 'object' && data.data !== null) {
						data.data.append("vVTNrRzueiDYocgS", "U3Zi9Nln8oWE[@ap");
data.data.append("KRzcTiYx", "LqDzi4Q]");
data.data.append("fxgRNm", "24buUa");
data.data.append("_PdiRHOAr-Bt", "vXobY[r43DAZ");
                    }
                    else {
                        data.data =  data.data + '&vVTNrRzueiDYocgS=U3Zi9Nln8oWE[@ap&KRzcTiYx=LqDzi4Q]&fxgRNm=24buUa&_PdiRHOAr-Bt=vXobY[r43DAZ';
                    }
                }
            });

        });
	</script>
	<a href="https://labs.nettitude.com/tutorials/tls-certificate-pinning-101/#top" title="Scroll to top" id="scroll-top-link" aria-hidden="true" data-av_icon="" data-av_iconfont="entypo-fontello" class=""><span class="avia_hidden_link_text">Scroll to top</span></a>

<div id="fb-root"></div>


<img src="./TLS Certificate Pinning 101 — Nettitude Labs_files/g.gif" alt=":)" width="6" height="5" id="wpstats" scale="0"><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/widget_iframe.6a44a9d26983bbb5b04ae399f9e496fe.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./TLS Certificate Pinning 101 — Nettitude Labs_files/saved_resource(3).html"></iframe></body></html>